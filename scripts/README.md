Metabarcoding Pipeline Scripts

This repository contains scripts to process metabarcoding data step-by-step, from setting up the environment to analyzing results. Follow the order of the scripts to ensure a smooth workflow.

---

Table of Contents
1. Scripts Overview
2. Prerequisites
3. Steps and Usage
4. Additional Notes

---

Scripts Overview

Script Name                - Description
01_prepare_qiime2_env.sh   - Sets up the QIIME2 environment.
02_data_processing.sh      - Processes raw sequencing data using QIIME2.
03_BOLDigger_pipeline.sh   - Identifies DNA sequences against the BOLD database using BOLDigger.
04_join_tables.py          - Joins the QIIME2 feature table with BOLDigger results.

---

Prerequisites

Before running the scripts, ensure you have the following installed:

1. Miniconda/Anaconda - For managing Python environments.
2. QIIME2 - Installed and activated for metabarcoding analysis.
3. Python 3 - With the pandas library installed.
4. BOLDigger - Installed and configured as part of the pipeline.

---

Steps and Usage

1. 01_prepare_qiime2_env.sh
Purpose: Sets up the QIIME2 environment for metabarcoding analysis.

Usage:
bash 01_prepare_qiime2_env.sh

Notes:
- This script installs QIIME2 version 2023.5.
- Ensure you have Miniconda installed before running this script.

---

2. 02_data_processing.sh
Purpose: Processes raw sequencing data using QIIME2, including importing FASTQ files, quality filtering, and DADA2 denoising.

Usage:
bash 02_data_processing.sh

Steps Performed:
- Imports FASTQ files into QIIME2.
- Performs quality filtering.
- Runs DADA2 to denoise sequences and create a feature table.
- Exports results as FASTA and feature tables for further analysis.

User Input Required:
- Update the script with the correct paths to your raw sequencing data and output directories.

---

3. 03_BOLDigger_pipeline.sh
Purpose: Identifies DNA sequences against the BOLD database using BOLDigger.

Usage:
bash 03_BOLDigger_pipeline.sh

Steps Performed:
- Runs BOLDigger's identify function with user-defined thresholds.
- Outputs results in Excel format.

User Input Required:
- Specify the input FASTA file path in the script.
- Set the desired thresholds for species, genus, family, and order.

---

4. 04_join_tables.py
Purpose: Joins the QIIME2 feature table and BOLDigger results into a single dataset.

Usage:
python3 04_join_tables.py

Steps Performed:
- Loads the QIIME2 feature table (HDF5 format).
- Loads the BOLDigger results (CSV format).
- Merges the tables based on feature IDs.
- Outputs the joined table as an Excel file.

User Input Required:
- Update the script with the correct paths to the feature table and BOLDigger results.

---

Additional Notes

1. Ensure that all input file paths are correct before running the scripts.
2. The pipeline is designed for Linux systems and assumes that all dependencies are properly installed.
3. After each step, check the output directory to confirm successful execution.
4. For troubleshooting, refer to the logs generated by the scripts.

---

Example Workflow

1. Run 01_prepare_qiime2_env.sh to set up the QIIME2 environment.
2. Use 02_data_processing.sh to process raw sequencing data.
3. Identify DNA sequences using 03_BOLDigger_pipeline.sh.
4. Merge the feature table and BOLDigger results with 04_join_tables.py.
